"use strict";(()=>{var e={};e.id=164,e.ids=[164],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9697:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var r={};o.r(r),o.d(r,{POST:()=>c});var n=o(9303),a=o(8716),s=o(670),i=o(7070);async function p(e,t,o,r=2e3){let n=process.env.OPENROUTER_API_KEY;if(!n)throw Error("OPENROUTER_API_KEY not configured");let a=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({model:e,messages:[{role:"system",content:t},{role:"user",content:o}],temperature:.7,max_tokens:r})});if(!a.ok){let e=await a.json();throw Error(e.error?.message||"OpenRouter API error")}let s=await a.json();return{content:s.choices[0]?.message?.content||"",tokensUsed:s.usage?.total_tokens||0,model:e}}async function c(e){try{let{projectName:t,command:o,model:r,context:n}=await e.json();if(!o.trim())return i.NextResponse.json({error:"Command cannot be empty"},{status:400});let a=`You are an expert developer helping to modify and improve the "${t}" project. Your role is to:
1. Generate code modifications based on user requests
2. Provide clear, production-ready code snippets
3. Suggest improvements and best practices
4. Keep token usage minimal by being concise
5. Always provide complete, working code
${n?`
Context about the project:
${n}`:""}`,s=await p(r,a,o,2e3);return i.NextResponse.json({result:s.content,model:s.model,projectName:t,tokensUsed:s.tokensUsed})}catch(e){return console.error("AI Command error:",e),i.NextResponse.json({error:e instanceof Error?e.message:"Failed to process AI command"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/ai-command/route",pathname:"/api/ai-command",filename:"route",bundlePath:"app/api/ai-command/route"},resolvedPagePath:"/Users/wez/.openclaw/workspace/projects/openclaw-dashboard/app/api/ai-command/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:l}=d,h="/api/ai-command/route";function g(){return(0,s.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[276,972],()=>o(9697));module.exports=r})();